[project]
name = "rubicon-ml"
description = "an ML experiment tracking library for model development and governance"
license = {file = "LICENSE"}
requires-python = ">=3.8"

authors = [{name = "Ryan Soley", email = "ryan.soley@capitalone.com"}]
maintainers = [
    {name = "Ryan Soley"},
    {name = "Shania Mahmud"},
    {name = "Srilatha Ranganathan"},
    {name = "Stephen Pardy"},
]

classifiers = [
    "Development Status :: 4 - Beta",
    "Intended Audience :: Developers",
    "Intended Audience :: Science/Research",
    "License :: OSI Approved :: Apache Software License",
    "Natural Language :: English",
    "Topic :: Scientific/Engineering",
    "Topic :: Scientific/Engineering :: Artificial Intelligence",
    "Topic :: Scientific/Engineering :: Information Analysis",
    "Topic :: Scientific/Engineering :: Visualization",
    "Topic :: Software Development :: Libraries :: Python Modules",
    "Programming Language :: Python :: 3.8",
    "Programming Language :: Python :: 3.9",
    "Programming Language :: Python :: 3.10",
    "Programming Language :: Python :: 3.11",
]
keywords = [
    "experiment-tracking",
    "experimenting",
    "logging",
    "machine-learning",
    "model-development",
    "reproducibility",
    "tracking",
]

dynamic = ["readme", "version", "dependencies"]

[project.entry-points."intake.drivers"]
rubicon_ml_experiment = "rubicon_ml.intake_rubicon.experiment:ExperimentSource"

[project.optional-dependencies]
docs = [
    "furo",
    "ipython",
    "nbsphinx",
    "numpydoc",
    "sphinx",
    "sphinx-copybutton",
]
notebook = ["ipykernel", "jupyterlab", "nbconvert"]
prefect = ["prefect<=1.2.4,>=0.12.0"]
qa = [
    "black",
    "build",
    "edgetest",
    "flake8",
    "isort",
    "pre-commit",
    "versioneer[toml]",
    "setuptools",
    "twine",
    "wheel",
]
s3 = ["s3fs<=2023.9.0,>=0.4"]
tests = ["dask", "pytest", "pytest-cov", "rubicon-ml[notebook]"]
viz = ["dash<=2.13.0,>=2.0.0", "dash-bootstrap-components<=1.5.0,>=1.0.0"]

dev = [
    "rubicon-ml[docs]",
    "rubicon-ml[notebook]",
    "rubicon-ml[prefect]",
    "rubicon-ml[qa]",
    "rubicon-ml[s3]",
    "rubicon-ml[tests]",
    "rubicon-ml[ui]",
]

all = ["rubicon-ml[dev]"]  # alias for backwards compatibility
ui = ["rubicon-ml[viz]"]   # alias for backwards compatibility

[project.scripts]
rubicon_ml = "rubicon_ml.cli:cli"

[project.urls]
documentation = "https://capitalone.github.io/rubicon-ml"
repository = "https://github.com/capitalone/rubicon-ml"

# BUILD TOOLS

[build-system]
requires = ["rubicon-ml", "setuptools>=64.0.0", "tomli; python_version < '3.11'"]
build-backend = "setuptools.build_meta"

# DEV TOOLS

[edgetest]
command = "pytest --no-cov -m 'not run_notebooks and not write_files'"
extras = ["tests"]

[edgetest.envs.core]
python_version = "3.9"
extras = ["all"]
upgrade = [
	"click",
	"dash",
	"dash-bootstrap-components",
	"fsspec",
	"intake[dataframe]",
	"numpy",
	"pandas",
	"pyarrow",
	"PyYAML",
	"s3fs",
	"scikit-learn",
]

[tool.setuptools]
include-package-data = true
packages = ["rubicon_ml"]
zip-safe = false

[tool.setuptools.dynamic]
dependencies = {file = "requirements.txt"}
readme = {file = "README.md"}
version = {attr = "rubicon_ml.__version__"}

[tool.black]
line-length = 100
exclude = "(versioneer.py|_version.py)"

[tool.coverage.report]
exclude_lines = [
    "pragma: no cover",
    "raise AssertionError",
    "raise NotImplementedError",
    "if __name__ == .__main__.:",
]
omit = ["versioneer.py", "rubicon_ml/_version.py"]

[tool.isort]
line_length = 88
skip = ["versioneer.py", "rubicon_ml/_version.py", "rubicon_ml/client/__init__.py"]
filter_files = true
multi_line_output = 3
include_trailing_comma = true
force_grid_wrap = 0
combine_as_imports = true

[tool.pytest.ini_options]
markers = [
	"run_notebooks: tests that run Jupyter notebooks",
	"write_files: tests that physically write files to local and S3 filesystems",
]
addopts = "--cov=./rubicon_ml --cov-report=term-missing --cov-fail-under=90 -m='not write_files'"
minversion = "3.2"
xfail_strict = true

[tool.versioneer]
vcs = "git"
style = "pep440"
versionfile_source = "rubicon_ml/_version.py"
versionfile_build = "rubicon_ml/_version.py"
tag_prefix = ""
parentdir_prefix = "rubicon-ml-"
